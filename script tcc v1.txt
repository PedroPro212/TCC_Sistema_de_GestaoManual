CREATE DATABASE metalurgicasaveiro;
USE metalurgicasaveiro;

CREATE TABLE setor(
    id int AUTO_INCREMENT PRIMARY KEY NOT null,
    descricao varchar(50) NOT null
);

CREATE TABLE funcionarios(
    id int primary key auto_increment not null,
    nome varchar(300) not null,
    data_nascimento date,
    cpf varchar(11) not null,
    email varchar(100),
    tel varchar(11),
    id_setor int,
    
    foreign key (id_setor) references setor(id)
);

CREATE TABLE acesso(
    id int primary key auto_increment not null,
    descricao varchar(100)
);

CREATE TABLE login(
    id int PRIMARY KEY AUTO_INCREMENT NOT NULL,
    registro INT,
    senha varchar(6),
    id_acesso int,
    
    FOREIGN KEY (registro) REFERENCES funcionarios(id),
    FOREIGN KEY (id_acesso) REFERENCES acesso(id)
);

CREATE TABLE TecnicoQualidade(
    id int AUTO_INCREMENT PRIMARY KEY NOT null,
    nome varchar(200) NOT null,
    registro varchar(6) NOT null,
    senha varchar(6) NOT null
);

CREATE TABLE operador(
    id int PRIMARY KEY AUTO_INCREMENT NOT null,
    registro int NOT null,
    idSetor int,
    FOREIGN KEY (idSetor) REFERENCES setor(id),
    FOREIGN KEY (registro) REFERENCES funcionarios(id)
);

CREATE TABLE encarregado(
    id int AUTO_INCREMENT PRIMARY KEY NOT null,
    nome varchar(200) NOT null,
    registro varchar(6) NOT null,
    senha varchar(6) NOT null,
    idSetor int,
    FOREIGN KEY (idSetor) REFERENCES setor(id)
);

CREATE TABLE maquina(
    id varchar(6) PRIMARY KEY NOT null,
    tipo varchar(200) NOT null
);

CREATE TABLE produto(
    id int PRIMARY KEY AUTO_INCREMENT NOT NULL,
    descricao varchar(100) NOT NULL,
    id_setor int,
    
    FOREIGN KEY (id_setor) REFERENCES setor(id)
);

CREATE TABLE processo(
    id int,
    id_produto INT NOT NULL,
    datahoraIni datetime,
    datahoraFin DATETIME,
    noPecas int,
    lotePecas varchar(20),
    idOperador int,
    etapaProcesso varchar(30),
    idMaquina varchar(6),
    loteTinta varchar(20),
    FOREIGN KEY (idOperador) REFERENCES operador(id),
    FOREIGN KEY (idMaquina) REFERENCES maquina(id),
    FOREIGN KEY (id_produto) REFERENCES produto(id)
);

insert into acesso(descricao) values ("Produção");
insert into acesso(descricao) values ("Supervisor");
insert into acesso(descricao) values ("Técnico de Qualidade");
INSERT INTO acesso VALUES(NULL, "Dev");

INSERT INTO setor VALUES(NULL, "Corte");
INSERT INTO setor VALUES(NULL, "Pintura por Imersão");
INSERT INTO setor VALUES(NULL, "Prensa");
INSERT INTO setor VALUES(NULL, "Ponteadeira");
INSERT INTO setor VALUES(NULL, "Viradeira");
INSERT INTO setor VALUES(NULL, "Montagem");
INSERT INTO setor VALUES(NULL, "Banho");

INSERT INTO funcionarios VALUES(NULL, "Pedro Henrique Oliveira", "2004-01-02", "12312312312", "pedro@gmail.com", "35997444848" , 1);
INSERT INTO funcionarios VALUES(NULL, "Filipe Fonseca Coura", "2005-05-16", "12312312312", "filipe@gmail.com", "79968718272" , 2);
INSERT INTO funcionarios VALUES(NULL, "Matheus Henrique Carvalho", "2002-06-18", "60193219085", "matheus@gmail.com", "47980171317", 6);
INSERT INTO funcionarios VALUES(NULL, "Antônio Francisco de Joarez", "1986-12-02", "63961630046", "Antonio@gmail.com", "68989401974", 5);

INSERT INTO login VALUES(NULL, 1, "1234", 4);
INSERT INTO login VALUES(NULL, 2, "1234", 2);
INSERT INTO login VALUES(NULL, 3, "1234", 2);
INSERT INTO login VALUES(NULL, 4, "1234", 1);

INSERT INTO produto VALUES(NULL, "Dobradiças", 2);
INSERT INTO produto VALUES(NULL, "Caixa de Correio", 2);
INSERT INTO produto VALUES(NULL, "Carroceria", 2);
INSERT INTO produto VALUES(NULL, "Fornos", 2);
INSERT INTO produto VALUES(NULL, "Incêndio", 2);
INSERT INTO produto VALUES(NULL, "Trincos", 2);

ALTER TABLE maquina ADD id_setor int
